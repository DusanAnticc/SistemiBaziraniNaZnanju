package sbnz.integracija;
import sbnz.integracija.example.model.Log;
import sbnz.integracija.example.model.LogTemperatures;
import java.util.List;
import sbnz.integracija.example.model.SteamMachine;

import java.util.ArrayList;
import java.util.Map;

dialect 'java'

rule "reportSuspiciousBehavior"
	agenda-group "reporSuspiciousBehavior"
	when
	    $machina : SteamMachine()
		$logs : List() from collect(Log(steamMachine.getId() == $machina.getId()))
	then
	if($logs.size() > 2)
		System.out.println("machines( " + $machina + " ) need service");
end

rule "MeasuredTemperatureMax"
	agenda-group "MeasuredTemperature"
	when
		$maxTemp:  Number() from accumulate( LogTemperatures($t: temperatures),max($t))
	then
		System.out.println($maxTemp);
end

rule "MeasuredTemperatureMin"
	agenda-group "MeasuredTemperature"
	when
		$minTemp:  Number() from accumulate( LogTemperatures($t: temperatures),min($t))
	then
		System.out.println($minTemp);
end